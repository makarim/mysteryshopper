<?php include_once("header.html")?>

<div id="wrap">  <br />
	<?php include_once("home_left.html")?>
    <div class="admincontent">
		<?php include_once("home_assignmenttop.html")?>
		
<script src="<?php echo $www_site_url?>/public/js/common.js" type="text/javascript"></script>
<script src="<?php echo $www_site_url?>/public/js/vote.js" type="text/javascript"></script>
<script>

function checkform(form){
	var g=function(n){
		return form.getElementsByTagName(n);
	};
	var va=function(e){
		if(e.name) return encodeURIComponent(e.value);
	};
	var check=function(r){
		for(var i=0;i<r.length;i++){
			if(r[i].checked) return true;
		}
		return false;
	}
	var result = true;
	
	var input = g('input');
	for(var i=0;i<input.length;i++){
		var v = va(input[i]);
		if(input[i].type=='text' || input[i].type=='hidden'){
			if( v==''){
				input[i].parentNode.style.border='1px solid red';
				result=false;
			}else{
				input[i].parentNode.style.border='';
			}
		} 
		if(input[i].type=='radio'){
			if(check(form.elements[input[i].name])){
				input[i].parentNode.style.border='';
			}else{
				input[i].parentNode.style.border='1px solid red';
			}
		}
	}
	
	var textarea = g('textarea');
	for(var i=0;i<textarea.length;i++){
		var v=va(textarea[i]);
		if(v==''){
			textarea[i].style.border='1px solid red';
			result=false;
		}else{
			textarea[i].style.border='';
		}
	}
	if(!result) alert("对不起，请完成标红的题目！");
	if(result && confirm("请注意：未执行任务而填写调查问卷，将会被工作人员审查出来！确认要提交吗？")){
		return result;
	}else{
		return false;
	}
	

}
	
	
</script>

	<?php if($is_view && $assignmentinfo['a_quiz_pass']>0){
		if(isset($report_questions) && is_array($report_questions)){?>

		<form action="<?php echo $www_site_url?>/index.php" method="post" onsubmit="return checkform(this);">
				<input type="hidden" name="action" value="home">
				<input type="hidden" name="op" value="savereport">
				<input type="hidden" name="a_id" value="<?php echo $a_id;?>">
				
				<table border="0" width="100%" cellspacing="10" class="clear">
				
					<?php
							foreach ($report_questions as $k=>$v){?>	
					<tr>
							<td bgcolor="#efefef" height="30"><?php echo $k+1;?>. <?php echo $v['rq_question']?> <span id="span_ch_<?php echo $v['rq_id'];?>"></span></td>
					</tr>		
					<tr>
							<td>
								<?php if($v['rq_type']==2){?><div id="voteimg_<?php echo $v['rq_id'];?>"></div>	
								<input type="hidden" id="rq_ans_<?php echo $v['rq_id'];?>" name="rq_ans_<?php echo $v['rq_type']."_".$v['rq_id'];?>" value="<?php echo $v['answer'];?>">
								<script>create_vote_img(<?php echo $v['rq_id'];?>,'<?php echo $v['answer'];?>');</script>	
								
								<?php }else if($v['rq_type']==1){ ?>		
								<label><input type="radio" name="rq_ans_<?php echo $v['rq_type']."_".$v['rq_id'];?>" value="Y" <?php if($v['answer']=='Y')echo 'checked'; ?>>Yes ;</label>&nbsp;&nbsp;&nbsp;&nbsp;<label><input type="radio" name="rq_ans_<?php echo $v['rq_type']."_".$v['rq_id'];?>" value="N"  <?php if($v['answer']=='N')echo 'checked'; ?>>No;</label>
								
								<?php }else if($v['rq_type']==3){ 
									if($v['rq_group']==4){
									?>	
									<textarea  class="report_textarea" name="rq_ans_<?php echo $v['rq_type']."_".$v['rq_id'];?>"><?php echo $v['answer']; ?></textarea>
								
								<? }else{?>
								<textarea  style="width:100%;font-size:12px;height:60px;" name="rq_ans_<?php echo $v['rq_type']."_".$v['rq_id'];?>"><?php echo $v['answer']; ?></textarea>
								
								<?php } }else if($v['rq_type']==4){ ?>	
								<input type="text" size="6" name="rq_ans_<?php echo $v['rq_type']."_".$v['rq_id'];?>" value="<?php echo $v['answer']; ?>">	分钟
								<?php }?>		
							</td>
							
					</tr>
					
						<?php }
						?>
					<tr class="nobg">
						<td><input type="submit" value="<?php echo lang('submit')?>" class="btn" /></td>
					</tr>
				</table>

				</form>
  <?php }
	}else{?>
   <p>&nbsp;</p>
   <p>&nbsp;</p>
   <p>&nbsp;</p>
   <p>请预先报名，通过小测试，执行完任务后才能填写报告！</p>
  <?php }?>
  
  </div>
</div>
<?php include_once("footer.html")?>
